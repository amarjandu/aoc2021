from typing import ClassVar, Mapping, Callable, Tuple
import operator

import attr

input = ["forward 2",
         "down 7",
         "down 8",
         "forward 9",
         "down 8",
         "forward 9",
         "forward 8",
         "down 3",
         "forward 8",
         "forward 5",
         "up 2",
         "down 9",
         "down 4",
         "forward 4",
         "forward 3",
         "down 8",
         "down 9",
         "forward 5",
         "down 1",
         "up 1",
         "forward 4",
         "up 5",
         "forward 2",
         "down 6",
         "forward 9",
         "forward 3",
         "forward 7",
         "down 6",
         "down 1",
         "forward 8",
         "down 3",
         "forward 1",
         "up 6",
         "down 1",
         "down 2",
         "forward 9",
         "down 7",
         "down 1",
         "down 7",
         "down 7",
         "up 5",
         "down 8",
         "forward 6",
         "up 8",
         "up 2",
         "forward 6",
         "up 1",
         "down 9",
         "forward 8",
         "forward 4",
         "up 3",
         "forward 7",
         "down 2",
         "down 8",
         "forward 5",
         "down 9",
         "up 4",
         "forward 7",
         "forward 5",
         "down 5",
         "down 5",
         "forward 3",
         "forward 2",
         "down 2",
         "up 4",
         "up 7",
         "down 8",
         "up 8",
         "forward 1",
         "up 4",
         "forward 4",
         "down 2",
         "forward 5",
         "forward 7",
         "down 4",
         "forward 8",
         "down 2",
         "forward 5",
         "forward 9",
         "forward 6",
         "forward 5",
         "down 5",
         "forward 4",
         "forward 3",
         "down 7",
         "down 8",
         "forward 9",
         "forward 7",
         "down 3",
         "down 6",
         "forward 4",
         "down 7",
         "up 9",
         "down 8",
         "up 7",
         "up 3",
         "forward 6",
         "forward 9",
         "down 2",
         "down 3",
         "down 1",
         "down 3",
         "forward 8",
         "forward 3",
         "forward 9",
         "down 5",
         "up 1",
         "up 2",
         "down 9",
         "up 9",
         "down 5",
         "down 9",
         "forward 1",
         "down 3",
         "down 5",
         "down 1",
         "forward 7",
         "down 6",
         "forward 7",
         "forward 4",
         "up 2",
         "up 1",
         "forward 9",
         "down 2",
         "down 6",
         "down 5",
         "down 6",
         "forward 8",
         "down 5",
         "forward 1",
         "forward 2",
         "down 7",
         "down 5",
         "down 7",
         "up 9",
         "down 9",
         "up 4",
         "down 7",
         "up 8",
         "down 9",
         "forward 3",
         "down 6",
         "down 2",
         "forward 9",
         "down 4",
         "up 7",
         "forward 3",
         "down 5",
         "forward 8",
         "forward 9",
         "down 2",
         "up 5",
         "forward 2",
         "forward 9",
         "up 5",
         "down 2",
         "forward 8",
         "forward 6",
         "down 7",
         "down 3",
         "forward 4",
         "forward 3",
         "forward 9",
         "up 4",
         "up 4",
         "forward 7",
         "up 3",
         "forward 6",
         "down 7",
         "up 8",
         "forward 2",
         "up 1",
         "down 6",
         "forward 4",
         "up 6",
         "up 6",
         "up 3",
         "forward 4",
         "forward 2",
         "forward 5",
         "forward 8",
         "down 9",
         "down 4",
         "down 3",
         "down 1",
         "down 6",
         "down 4",
         "down 5",
         "down 7",
         "down 5",
         "up 4",
         "forward 3",
         "down 4",
         "down 7",
         "down 7",
         "down 2",
         "forward 2",
         "forward 9",
         "up 6",
         "down 3",
         "up 9",
         "forward 8",
         "down 9",
         "up 2",
         "up 2",
         "up 2",
         "up 1",
         "down 6",
         "forward 9",
         "forward 2",
         "forward 2",
         "forward 2",
         "forward 5",
         "up 3",
         "down 7",
         "down 6",
         "down 8",
         "up 3",
         "up 9",
         "down 3",
         "forward 1",
         "forward 7",
         "down 7",
         "down 1",
         "forward 3",
         "down 7",
         "down 9",
         "down 7",
         "down 3",
         "up 2",
         "down 6",
         "up 6",
         "down 1",
         "up 2",
         "forward 7",
         "up 2",
         "down 7",
         "up 2",
         "down 9",
         "down 3",
         "forward 6",
         "down 5",
         "down 1",
         "forward 5",
         "down 2",
         "down 6",
         "down 1",
         "down 3",
         "down 3",
         "down 5",
         "forward 2",
         "forward 4",
         "forward 8",
         "forward 6",
         "forward 4",
         "forward 9",
         "up 8",
         "down 5",
         "forward 1",
         "down 1",
         "forward 1",
         "forward 6",
         "up 1",
         "down 6",
         "down 3",
         "forward 9",
         "forward 5",
         "forward 4",
         "up 3",
         "up 7",
         "down 2",
         "up 4",
         "up 2",
         "down 1",
         "forward 6",
         "forward 9",
         "forward 4",
         "forward 2",
         "down 8",
         "forward 4",
         "forward 3",
         "up 5",
         "down 4",
         "forward 3",
         "down 8",
         "down 5",
         "down 5",
         "forward 1",
         "forward 6",
         "forward 4",
         "forward 5",
         "forward 9",
         "forward 5",
         "down 4",
         "forward 3",
         "forward 8",
         "down 8",
         "down 1",
         "up 4",
         "down 4",
         "up 7",
         "forward 2",
         "forward 6",
         "down 3",
         "down 5",
         "down 5",
         "down 8",
         "up 3",
         "down 2",
         "forward 4",
         "forward 2",
         "forward 4",
         "forward 9",
         "up 2",
         "down 7",
         "up 7",
         "down 2",
         "forward 4",
         "up 7",
         "forward 4",
         "down 2",
         "forward 7",
         "up 2",
         "down 3",
         "forward 5",
         "down 7",
         "down 2",
         "up 2",
         "up 1",
         "up 7",
         "up 9",
         "down 3",
         "forward 1",
         "forward 3",
         "down 2",
         "down 3",
         "forward 6",
         "down 7",
         "forward 9",
         "down 9",
         "forward 3",
         "forward 2",
         "down 1",
         "up 9",
         "down 4",
         "forward 4",
         "up 4",
         "forward 7",
         "up 3",
         "down 4",
         "down 9",
         "down 3",
         "forward 7",
         "down 6",
         "down 7",
         "down 6",
         "up 5",
         "forward 3",
         "forward 9",
         "up 2",
         "up 4",
         "up 9",
         "down 2",
         "forward 5",
         "up 1",
         "down 7",
         "down 5",
         "up 2",
         "forward 8",
         "down 8",
         "up 3",
         "forward 4",
         "down 9",
         "forward 6",
         "down 9",
         "down 5",
         "forward 6",
         "down 8",
         "up 6",
         "down 3",
         "forward 6",
         "forward 3",
         "down 3",
         "down 5",
         "down 7",
         "down 1",
         "down 5",
         "down 7",
         "down 5",
         "forward 3",
         "down 2",
         "forward 4",
         "up 4",
         "up 1",
         "up 7",
         "forward 1",
         "forward 5",
         "down 4",
         "down 8",
         "down 3",
         "forward 4",
         "down 3",
         "up 7",
         "down 6",
         "forward 9",
         "up 8",
         "forward 2",
         "forward 5",
         "down 6",
         "up 4",
         "forward 8",
         "forward 5",
         "down 6",
         "forward 2",
         "down 7",
         "forward 3",
         "forward 1",
         "forward 6",
         "down 9",
         "up 6",
         "down 4",
         "down 2",
         "up 8",
         "forward 4",
         "down 8",
         "forward 8",
         "up 9",
         "forward 7",
         "down 6",
         "up 9",
         "down 4",
         "up 6",
         "down 4",
         "down 3",
         "up 7",
         "up 4",
         "forward 5",
         "up 9",
         "down 9",
         "up 6",
         "down 3",
         "forward 8",
         "down 9",
         "forward 7",
         "up 3",
         "up 9",
         "forward 8",
         "down 3",
         "forward 3",
         "forward 5",
         "down 6",
         "forward 3",
         "down 4",
         "up 6",
         "forward 3",
         "forward 7",
         "down 1",
         "down 6",
         "down 4",
         "forward 6",
         "up 6",
         "down 5",
         "down 6",
         "down 4",
         "up 2",
         "down 7",
         "down 9",
         "down 2",
         "down 6",
         "forward 3",
         "forward 4",
         "down 5",
         "up 5",
         "down 5",
         "forward 3",
         "forward 6",
         "down 4",
         "down 7",
         "up 2",
         "forward 7",
         "down 7",
         "up 6",
         "up 3",
         "forward 9",
         "forward 8",
         "up 6",
         "forward 2",
         "down 2",
         "forward 8",
         "forward 4",
         "up 6",
         "forward 6",
         "down 8",
         "up 3",
         "up 5",
         "forward 6",
         "up 8",
         "down 1",
         "down 4",
         "up 9",
         "forward 6",
         "up 5",
         "down 6",
         "down 8",
         "down 9",
         "forward 5",
         "up 3",
         "down 7",
         "forward 3",
         "forward 6",
         "down 3",
         "down 1",
         "down 9",
         "up 9",
         "down 4",
         "down 7",
         "forward 2",
         "forward 4",
         "down 7",
         "forward 7",
         "up 5",
         "down 9",
         "up 7",
         "down 4",
         "forward 6",
         "down 5",
         "forward 4",
         "up 8",
         "down 4",
         "down 7",
         "forward 3",
         "down 6",
         "down 1",
         "forward 3",
         "down 4",
         "up 6",
         "up 5",
         "up 7",
         "forward 5",
         "down 4",
         "forward 7",
         "up 1",
         "down 4",
         "forward 4",
         "down 2",
         "down 6",
         "forward 1",
         "up 3",
         "up 8",
         "forward 6",
         "forward 6",
         "down 5",
         "forward 7",
         "down 6",
         "down 8",
         "forward 6",
         "down 6",
         "forward 3",
         "forward 5",
         "down 9",
         "down 5",
         "up 4",
         "down 5",
         "down 1",
         "forward 1",
         "forward 5",
         "down 2",
         "forward 5",
         "forward 2",
         "forward 5",
         "up 3",
         "forward 5",
         "up 8",
         "forward 9",
         "forward 3",
         "down 2",
         "up 2",
         "forward 7",
         "down 5",
         "up 1",
         "down 3",
         "down 7",
         "up 2",
         "forward 8",
         "forward 6",
         "forward 1",
         "forward 6",
         "forward 6",
         "down 5",
         "forward 4",
         "down 5",
         "forward 9",
         "forward 7",
         "down 7",
         "down 7",
         "down 9",
         "forward 4",
         "down 4",
         "forward 3",
         "down 6",
         "forward 5",
         "down 9",
         "forward 6",
         "up 7",
         "down 3",
         "up 4",
         "up 4",
         "down 1",
         "down 2",
         "up 5",
         "forward 6",
         "forward 2",
         "down 7",
         "up 6",
         "up 3",
         "down 8",
         "forward 1",
         "down 3",
         "up 9",
         "down 2",
         "forward 6",
         "forward 1",
         "forward 4",
         "up 1",
         "down 8",
         "down 2",
         "down 9",
         "down 5",
         "forward 3",
         "down 1",
         "down 6",
         "down 5",
         "down 3",
         "forward 1",
         "forward 9",
         "up 2",
         "down 3",
         "down 3",
         "down 9",
         "down 7",
         "forward 6",
         "forward 8",
         "forward 4",
         "up 7",
         "down 2",
         "forward 3",
         "forward 1",
         "up 4",
         "forward 8",
         "up 9",
         "forward 8",
         "forward 2",
         "down 5",
         "forward 2",
         "down 6",
         "down 6",
         "down 4",
         "forward 8",
         "down 6",
         "forward 2",
         "forward 8",
         "down 7",
         "down 6",
         "forward 2",
         "down 1",
         "down 8",
         "forward 2",
         "forward 9",
         "up 6",
         "forward 6",
         "down 3",
         "down 2",
         "up 5",
         "up 6",
         "down 6",
         "up 7",
         "forward 5",
         "forward 7",
         "down 1",
         "forward 7",
         "forward 9",
         "down 3",
         "forward 4",
         "forward 5",
         "down 1",
         "up 3",
         "forward 2",
         "up 5",
         "forward 2",
         "forward 1",
         "down 5",
         "down 4",
         "down 8",
         "up 8",
         "forward 3",
         "down 3",
         "forward 4",
         "down 6",
         "up 8",
         "down 5",
         "up 2",
         "down 1",
         "up 3",
         "forward 8",
         "up 6",
         "forward 9",
         "up 9",
         "down 5",
         "forward 2",
         "forward 9",
         "up 6",
         "forward 1",
         "down 2",
         "forward 4",
         "forward 4",
         "forward 1",
         "forward 5",
         "forward 1",
         "forward 4",
         "down 5",
         "down 1",
         "down 2",
         "down 2",
         "forward 7",
         "down 7",
         "down 7",
         "down 4",
         "down 7",
         "down 4",
         "down 3",
         "up 7",
         "up 1",
         "forward 2",
         "forward 3",
         "down 4",
         "down 5",
         "forward 9",
         "up 7",
         "forward 6",
         "down 1",
         "forward 6",
         "forward 6",
         "forward 8",
         "down 3",
         "forward 2",
         "down 6",
         "forward 9",
         "up 6",
         "up 6",
         "forward 7",
         "down 5",
         "down 6",
         "up 3",
         "down 5",
         "up 4",
         "forward 3",
         "down 7",
         "forward 9",
         "up 1",
         "down 1",
         "up 6",
         "down 3",
         "up 2",
         "down 5",
         "forward 3",
         "forward 6",
         "down 9",
         "down 4",
         "forward 7",
         "down 1",
         "up 1",
         "forward 3",
         "forward 5",
         "up 7",
         "down 3",
         "up 9",
         "up 9",
         "down 4",
         "up 4",
         "forward 8",
         "up 9",
         "down 8",
         "forward 6",
         "forward 4",
         "forward 9",
         "forward 8",
         "down 2",
         "forward 3",
         "forward 2",
         "down 3",
         "up 1",
         "forward 6",
         "down 3",
         "down 7",
         "down 3",
         "down 5",
         "down 9",
         "up 9",
         "forward 8",
         "forward 6",
         "down 8",
         "forward 3",
         "down 4",
         "down 2",
         "down 9",
         "forward 4",
         "forward 2",
         "up 4",
         "forward 1",
         "up 8",
         "up 1",
         "down 4",
         "up 2",
         "down 1",
         "up 7",
         "down 2",
         "down 4",
         "up 4",
         "forward 2",
         "down 3",
         "forward 2",
         "forward 3",
         "down 5",
         "forward 9",
         "forward 7",
         "down 1",
         "up 3",
         "down 3",
         "forward 3",
         "down 6",
         "forward 5",
         "up 3",
         "up 3",
         "up 1",
         "forward 7",
         "forward 1",
         "forward 2",
         "forward 2",
         "down 4",
         "up 7",
         "forward 1",
         "forward 1",
         "forward 6",
         "down 8",
         "up 8",
         "down 8",
         "down 4",
         "down 6",
         "forward 8",
         "forward 4",
         "forward 5",
         "down 2",
         "down 3",
         "forward 7",
         "down 6",
         "forward 4",
         "forward 1",
         "up 7",
         "up 5",
         "up 2",
         "forward 1",
         "forward 8",
         "forward 2",
         "up 9",
         "forward 4",
         "forward 5",
         "down 2",
         "forward 5",
         "forward 7",
         "down 3",
         "forward 1",
         "down 3",
         "up 5",
         "up 2",
         "up 2",
         "up 2",
         "forward 4",
         "forward 4",
         "forward 8",
         "forward 2",
         "down 3",
         "up 7",
         "down 4",
         "down 2",
         "down 7",
         "forward 2",
         "down 2",
         "forward 7",
         "up 9",
         "up 7",
         "forward 7",
         "forward 7",
         "down 3",
         "down 4",
         "up 4",
         "down 2",
         "down 8",
         "forward 4",
         "down 1",
         "up 6",
         "forward 4",
         "down 2",
         "up 8",
         "down 1",
         "down 8",
         "down 6",
         "up 9",
         "forward 4",
         "up 1",
         "down 2",
         "down 9",
         "down 7",
         "down 4",
         "down 8",
         "down 8",
         "up 1",
         "down 5",
         "up 5",
         "down 7",
         "up 7",
         "forward 5",
         "down 3",
         "forward 7",
         "up 5",
         "down 3",
         "forward 9",
         "up 5",
         "down 7",
         "forward 8",
         "forward 8",
         "down 2",
         "forward 7",
         "forward 8",
         "down 4",
         "up 7",
         "down 2",
         "up 7",
         "forward 5",
         "down 1",
         "down 3",
         "forward 9",
         "up 4",
         "forward 6",
         "forward 4",
         "down 5",
         "down 7",
         "forward 2",
         "forward 4",
         "down 2",
         "forward 1",
         "down 5",
         "up 2",
         "down 8",
         "down 1",
         "down 4",
         "down 8",
         "down 6",
         "forward 9",
         "forward 2",
         "forward 6",
         "forward 4",
         "down 1",
         "forward 8",
         "up 4",
         "forward 6",
         "down 4",
         "forward 4",
         "forward 3",
         "forward 6",
         "forward 9",
         "forward 8",
         "down 1",
         "forward 5",
         "down 8",
         "forward 7",
         "up 1",
         "down 3",
         "up 6",
         "forward 5",
         "forward 8",
         "forward 8",
         "forward 5",
         "forward 5",
         "forward 1",
         "up 9",
         "forward 7",
         "up 3",
         "down 2",
         "down 4",
         "forward 6",
         "up 2",
         "forward 5",
         "up 8",
         "forward 8",
         "forward 2",
         "forward 6",
         "forward 3",
         "up 4",
         "forward 3",
         "forward 6",
         ]


@attr.s(kw_only=True, auto_attribs=True)
class Submarine:
    x_pos: int
    z_pos: int
    aim: int

    @property
    def direction_mapping_problem_one(self) -> Mapping[str, Tuple[Callable, str]]:
        return {
            'forward': (operator.add, 'x_pos'),
            'down': (operator.add, 'z_pos'),
            'up': (operator.sub, 'z_pos')
        }

    def down(self, x):
        self.aim += x

    def up(self, x):
        self.aim -= x

    def forward(self, x):
        self.x_pos += x
        self.z_pos += (self.aim * x)

    @property
    def direction_mapping(self) -> Mapping[str, Callable]:
        return {
            'forward': self.forward,
            'down': self.down,
            'up': self.up
        }

    def move_position_problem_1(self, input: str):
        direction, magnitude = input.split(' ')
        magnitude = int(magnitude)
        assert direction in self.direction_mapping_problem_one.keys(), direction
        operator_, attribute_name = self.direction_mapping_problem_one[direction]
        self.__setattr__(attribute_name,
                         operator_(self.__getattribute__(attribute_name), magnitude))

    def move_position(self, input: str):
        direction, magnitude = input.split(' ')
        magnitude = int(magnitude)
        assert direction in self.direction_mapping.keys(), direction
        callable_ = self.direction_mapping[direction]
        callable_(magnitude)


def problem_one():
    sub = Submarine(x_pos=0, z_pos=0, aim=0)
    for direction in input:
        sub.move_position_problem_1(direction)
    print(sub)
    print(sub.x_pos * sub.z_pos)  # 1670340


def problem_two():
    sub = Submarine(x_pos=0, z_pos=0, aim=0)
    for vector in input:
        sub.move_position(vector)
    print(sub)
    print(sub.x_pos * sub.z_pos)


def main():
    # problem_one()
    problem_two()


if __name__ == '__main__':
    main()
